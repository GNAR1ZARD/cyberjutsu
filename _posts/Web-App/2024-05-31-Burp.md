---
layout: post
title: "Web Application Pentesting with Burp Suite"
date: 2024-05-31
categories: Web-App
---

Burp Suite is a powerful web vulnerability scanner and penetration testing tool used by security professionals to identify, analyze, and exploit web application vulnerabilities. This guide provides a comprehensive overview of Burp Suite's capabilities, focusing on detailed instructions and practical examples.

### How Burp Suite Works

Burp Suite operates by intercepting and manipulating the communication between a client's browser and the web server. This allows security professionals to analyze and modify requests and responses, identify security vulnerabilities, and simulate attacks. Here's a detailed look at how Burp Suite works:

#### Client-Side Interception

Burp Suite intercepts HTTP and HTTPS traffic between the client's browser and the web server. This interception enables the tester to inspect, modify, and replay requests and responses to uncover vulnerabilities.

1. **Proxy Configuration**: By configuring the client's browser to route traffic through Burp Suite's proxy server, which will be covered later in the guide, all communication between the browser and the web server is captured.
2. **Certificate Installation**: To intercept HTTPS traffic, Burp Suite generates a CA certificate that must be installed in the browser. This allows Burp Suite to decrypt and inspect secure traffic.
3. **Request/Response Inspection**: Intercepted requests and responses can be viewed, modified, and replayed to test the behavior of the web application.

#### Key Components

Burp Suite is composed of several tools that work together to facilitate comprehensive web application testing:

1. **Burp Proxy**: Intercepts and allows modification of HTTP and HTTPS traffic. This tool is fundamental for intercepting requests and responses between the browser and the target application, enabling the tester to manipulate and analyze them in real-time.
2. **Burp Repeater**: Allows manual editing and re-sending of individual requests. It's particularly useful for refining and understanding how the application handles various inputs, making it easier to pinpoint and exploit specific vulnerabilities.
3. **Burp Intruder**: Automates customized attacks to test for vulnerabilities. It is highly configurable and can be used to perform brute force attacks, fuzzing, and other automated testing techniques to uncover issues such as SQL injection and cross-site scripting.
4. **Burp Scanner**: Analyzes web applications for security issues. This tool automates the detection of numerous types of vulnerabilities, including those listed in the OWASP Top Ten, by thoroughly scanning the application's endpoints.
5. **Burp Collaborator**: Detects out-of-band vulnerabilities by interacting with external systems. This tool helps identify issues that require external interaction, such as DNS or HTTP-based vulnerabilities that may not be apparent from within the web application alone.

**Note**: Some of these features are limited to the Enterprise Edition of Burp Suite. For example, Burp Scanner and Burp Collaborator have advanced capabilities in the Enterprise Edition that are not available in the Community Edition. Even in the Community Edition, features like Burp Intruder and Burp Scanner may be rate-limited or have reduced functionality. This makes the Community Edition suitable for learning and basic testing, while the Enterprise Edition is designed for more extensive and professional use cases.

### Getting Started with Burp Suite

Upon launching Burp Suite, you will be presented with various tools designed to assist in web security testing. This guide will focus on using the Burp Proxy, Repeater, and Intruder, as well as practical examples to illustrate their use.

#### Burp Proxy

Burp Proxy is essential for intercepting and modifying HTTP and HTTPS traffic between your browser and the target web application. It allows for detailed inspection and modification of requests and responses.

##### Setting Up Burp Proxy

1. **Configure Browser to Use Burp Proxy**:
   - Set your browser's proxy settings to route traffic through Burp Suite. Typically, this involves setting the HTTP and HTTPS proxy to `127.0.0.1:8080`.

2. **Install Burp's CA Certificate**:
   - To intercept HTTPS traffic, install Burp's CA certificate in your browser. This is found in `Proxy > Intercept > CA Certificate`.

**Note**: Alternatively, you can use the Burp Suite Browser, which is pre-configured to work seamlessly with Burp Proxy. This can be accessed via `Proxy > Open Browser` in the Burp Suite interface.

##### Using Burp Proxy

1. **Interception**:
   - Navigate to `Proxy > Intercept` and ensure interception is enabled.
   - Intercepted requests can be modified before forwarding to the server.

2. **Site Map and Issue Definitions**:
   - As you browse, Burp will build a site map of the target application, accessible under `Target > Site map`.
   - Burp will automatically flag potential issues, providing detailed descriptions and severity ratings.

##### Practical Example: Testing File Uploads

1. **Intercept Request**: Upload a file through the target application and intercept the request using Burp Proxy.
2. **Modify Payload**: Change the file extension or content to include a malicious payload (e.g., a PHP shell).
3. **Analyze Response**: Forward the request and analyze the server's response to determine if the file was accepted and executed.

### Burp Repeater

The Repeater tool is used for manually editing and re-sending individual HTTP requests, allowing you to test how the application responds to various inputs.

#### Basic Usage

1. **Send Request to Repeater**:
   - Right-click an intercepted request in Burp Proxy and select "Send to Repeater".

2. **Modify Request**:
   - Make changes to the request parameters, headers, or body.

3. **Send and Analyze**:
   - Click "Send" to transmit the modified request and review the response.

#### Practical Example: Authentication Bypass

1. **Capture Login Request**: Intercept the login request using Burp Proxy.
2. **Modify Parameters**: Change the login credentials to common bypass techniques such as `admin'--`.
3. **Send Request**: Use Repeater to send the modified request.
4. **Analyze Response**: Review the server's response to determine if the bypass was successful.

### Burp Intruder

The Intruder tool is designed for automating customized attacks to find and exploit vulnerabilities within web applications. It is highly configurable and can test for various types of injections and exploits.

### Fuzzing

Fuzzing is a key capability of Burp Intruder, involving the automated injection of a large number of payloads into the application to test how it handles unexpected or malformed input. This process helps uncover vulnerabilities by identifying how the application responds to a wide range of inputs. Fuzzing can detect issues such as buffer overflows, SQL injection, and cross-site scripting (XSS), making it an essential technique for comprehensive security testing.

### Attack Types and Payloads

#### Wordlist

For the examples, we'll use a small wordlist:

- Payloads: ["admin", "password", "1234"]

1. **Sniper**: A single payload position attack, injecting payloads into one specified position. Useful for testing individual injection points.
   - **Example**: Suppose you are testing a login form with the following fields: username and password.
     - Target: `username`
     - Wordlist: ["admin", "password", "1234"]
     - **Payload Injection**:
       - Request 1: `username=admin&password=`
       - Request 2: `username=password&password=`
       - Request 3: `username=1234&password=`

2. **Battering Ram**: Uses the same payload across multiple positions within the request. Useful for testing the same input in multiple fields.
   - **Example**: Suppose you are testing a form with username and password fields again.
     - Wordlist: ["admin", "password", "1234"]
     - **Payload Injection**:
       - Request 1: `username=admin&password=admin`
       - Request 2: `username=password&password=password`
       - Request 3: `username=1234&password=1234`

3. **Pitchfork**: Allows multiple payload sets to be used in parallel across different positions. Effective for testing interactions between different input fields.
   - **Example**: Suppose you have two fields: username and password, and you want to test different combinations of payloads.
     - Payload Set 1: ["admin", "password"]
     - Payload Set 2: ["1234", "guest"]
     - **Payload Injection**:
       - Request 1: `username=admin&password=1234`
       - Request 2: `username=password&password=guest`
       - Request 3: `username=admin&password=guest`
       - Request 4: `username=password&password=1234`

4. **Cluster Bomb**: Tests combinations of payloads across multiple positions. Useful for discovering complex injection scenarios.
   - **Example**: Suppose you have a form with three fields: username, password, and email.
     - Payload Set for Username: ["admin", "user"]
     - Payload Set for Password: ["1234", "password"]
     - Payload Set for Email: ["test@example.com", "user@example.com"]
     - **Payload Injection**:
       - Request 1: `username=admin&password=1234&email=test@example.com`
       - Request 2: `username=admin&password=1234&email=user@example.com`
       - Request 3: `username=admin&password=password&email=test@example.com`
       - Request 4: `username=admin&password=password&email=user@example.com`
       - Request 5: `username=user&password=1234&email=test@example.com`
       - Request 6: `username=user&password=1234&email=user@example.com`
       - Request 7: `username=user&password=password&email=test@example.com`
       - Request 8: `username=user&password=password&email=user@example.com`

By using these attack types with the given wordlist, you can systematically test various injection points and interactions within a web application's input fields.

#### Practical Example: SQL Injection

1. **Set Positions**: Identify the username and password fields in the HTTP request.
2. **Configure Payloads**: Load a list of common SQL injection payloads.
3. **Run Attack**: Use the Sniper attack to inject each payload into the username field while monitoring the responses for successful injection indicators.

### Burp Scanner

Burp Scanner is a powerful tool for automating the discovery of security vulnerabilities in web applications. It performs a detailed analysis of the target application, identifying common issues such as XSS, SQL injection, and other vulnerabilities.

#### Using Burp Scanner

1. **Initiate a Scan**:
   - Go to `Scanner > Live scanning` and enable scanning.
   - Configure the scope to include the URLs you want to scan.

2. **Automated Crawling and Auditing**:
   - Burp Scanner will crawl the application, discovering all reachable content and functionality.
   - It will then audit the discovered content for vulnerabilities.

3. **Review Findings**:
   - Navigate to `Scanner > Issue activity` to view a detailed list of identified issues.
   - Each issue includes a description, severity rating, and remediation advice.

##### Practical Example: Comprehensive Application Scan

1. **Define Scope**: Set the scope to include the entire application.
2. **Run Scan**: Start the scan and allow Burp Scanner to analyze the application.
3. **Review Results**: Examine the scan results to identify and prioritize remediation of discovered vulnerabilities.

### Burp Collaborator

Burp Collaborator is a unique tool that identifies out-of-band vulnerabilities by interacting with external systems. It is particularly useful for detecting vulnerabilities that involve external interactions, such as SSRF (Server-Side Request Forgery) and blind XSS.

#### Using Burp Collaborator

1. **Set Up Collaborator**:
   - Ensure Burp Suite is configured to use Burp Collaborator. This is typically set up automatically.

2. **Generate Payloads**:
   - Use Burp Collaborator to generate unique payloads that can be injected into requests.

3. **Monitor Interactions**:
   - Burp Collaborator will monitor for any interactions with the generated payloads, indicating a potential vulnerability.

##### Practical Example: Testing for SSRF

1. **Inject Payload**: Intercept a request that makes a server-side request and inject a Burp Collaborator payload.
2. **Monitor Interactions**: Use Burp Collaborator to detect any outbound requests made by the server to the payload URL.
3. **Analyze Results**: If interactions are detected, this indicates a potential SSRF vulnerability.

### Advanced Features of Burp Suite

Beyond the basic tools, Burp Suite offers advanced features to enhance your testing capabilities.

#### Macros and Session Handling

Burp Suite allows you to set up macros for automating complex sequences of actions, such as session handling and authentication. This is particularly useful for maintaining session states and automating repetitive tasks.

1. **Set Up Macros**:
   - Navigate to `Project options > Sessions`.
   - Click on `Add` to create a new macro.
   - Record the sequence of actions you want to automate, such as logging in and retrieving session cookies.

2. **Session Handling Rules**:
   - Configure session handling rules to use the recorded macro.
   - This ensures that Burp Suite can maintain valid session states during testing, avoiding issues with session timeouts.

### Common Use Cases for Burp Suite

Burp Suite is used for a variety of web application security tests. Here are some of the most common use cases, including practical examples:

#### Fuzzing for Input Validation

Fuzzing, as previously mentioned, involves sending a large number of payloads to an application to discover input validation vulnerabilities.

##### Example: Testing a Search Function

1. **Set Up Intruder**: Intercept a search request and send it to Intruder.
2. **Configure Payloads**: Load a list of fuzzing payloads, including special characters, SQL commands, and JavaScript snippets.
3. **Run Attack**: Use the Sniper attack to inject each payload into the search field.
4. **Analyze Responses**: Look for unusual responses, such as error messages or unexpected behavior, indicating input validation issues.

#### Cross-Site Scripting (XSS)

XSS vulnerabilities allow attackers to inject malicious scripts into web pages viewed by other users.

##### Example: Testing Comment Sections

1. **Identify Input Points**: Find input fields that reflect user input, such as comment sections.
2. **Inject Payloads**: Use Repeater or Intruder to inject XSS payloads (e.g., `<script>alert('XSS')</script>`).
3. **Analyze Responses**: Check if the payload is executed in the browser, indicating an XSS vulnerability.

#### SQL Injection

SQL injection vulnerabilities occur when an application improperly handles user-supplied data in SQL queries.

##### Example: Testing Login Forms

1. **Set Up Intruder**: Intercept a login request and send it to Intruder.
2. **Configure Payloads**: Load a list of SQL injection payloads (e.g., `' OR 1=1--`).
3. **Run Attack**: Use the Sniper attack to inject each payload into the username and password fields.
4. **Analyze Responses**: Look for responses indicating successful login without valid credentials.

#### Command Injection

Command injection vulnerabilities allow attackers to execute arbitrary commands on the server.

##### Example: Testing File Upload Functions

1. **Intercept File Upload Request**: Capture the file upload request using Burp Proxy.
2. **Modify Payload**: Change the file content to a script that executes commands (e.g., `<?php system($_GET['cmd']); ?>`).
3. **Analyze Response**: Upload the modified file and access it through the web application, attempting to execute commands via the `cmd` parameter.

#### Directory Traversal

Directory traversal vulnerabilities allow attackers to access files and directories stored outside the web root.

##### Example: Testing File Download Functions

1. **Set Up Repeater**: Intercept a file download request and send it to Repeater.
2. **Modify Path**: Change the file path to include directory traversal sequences (e.g., `../../etc/passwd`).
3. **Analyze Response**: Send the modified request and check if the server returns files from outside the web root.

### Conclusion

Burp Suite's comprehensive set of tools makes it an indispensable asset for web application security testing. By mastering the key components of Burp Suite, security professionals can efficiently identify and exploit vulnerabilities, ensuring robust security assessments. This guide has provided a detailed overview of Burp Suite's advanced features and practical use cases, helping users maximize the effectiveness of their web security testing efforts.
